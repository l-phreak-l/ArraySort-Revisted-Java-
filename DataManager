import java.util.ArrayList;
import java.util.Collections;
import java.util.Comparator;
import java.util.List;
public class DataManager {
    private List<Object> dataList;
    private boolean containsNumbers;
    private boolean containsNames;

    public DataManager() {
        this.dataList = new ArrayList<>();
        this.containsNumbers = false;
        this.containsNames = false;
    }

    public void addEntry(Object entry, boolean isNumber) {
        dataList.add(entry);

        if (isNumber){
            containsNumbers = true;
        } else {
            containsNames = true;
        }
    }
    public List<Object> getUnsortedData(){
        return new ArrayList<>(dataList);
    }

    public List<Object> getSortedData() {
        List<Object> sortedList = new ArrayList<>(dataList);
        return sortedList;
    }
    //
    public List<Object> getSortedData(int algorithmChoice) {
        List<Object> sortedList = new ArrayList<>(dataList);

        switch(algorithmChoice) {
            case 1: // Bubble Sort
                return bubbleSort(sortedList);
            case 2: // Selection Sort
                return selectionSort(sortedList);
            case 3: // Insertion Sort
                return insertionSort(sortedList);
            default: // Default Java sort numerical/ case sensitive alphabetical
                return defaultSort(sortedList);
        }
    }

    // default sort
    private List<Object> defaultSort(List<Object> list) {
        List<Object> sorted = new ArrayList<>(list);
        if (containsNumbers && !containsNames){
            Collections.sort(sorted, new NumericComparator());
        } else if (!containsNumbers && containsNames){
            Collections.sort(sorted, new AlphabeticComparator());
        } else{
            Collections.sort(sorted, new MixedDataComparator());
        }
        return sorted;
    }

    // bub sort
    private List<Object> bubbleSort(List<Object> list) {
        List<Object> sorted = new ArrayList<>(list);
        int n = sorted.size();

        for (int i = 0; i < n - 1; i++) {
            for (int j = 0; j < n - i - 1; j++) {
                if (compareObjects(sorted.get(j), sorted.get(j + 1)) > 0) {
                    Object temp = sorted.get(j);
                    sorted.set(j, sorted.get(j + 1));
                    sorted.set(j + 1, temp);
                }
            }
        }
        return sorted;
    }

    // selection sort
    private List<Object> selectionSort(List<Object> list) {
        List<Object> sorted = new ArrayList<>(list);
        int n = sorted.size();

        for (int i = 0; i < n - 1; i++) {
            int minIndex = i;
            for (int j = i + 1; j < n; j++) {
                if (compareObjects(sorted.get(j), sorted.get(minIndex)) < 0) {
                    minIndex = j;
                }
            }

            Object temp = sorted.get(minIndex);
            sorted.set(minIndex, sorted.get(i));
            sorted.set(i, temp);
        }
        return sorted;
    }

    // insertion sort
    private List<Object> insertionSort(List<Object> list) {
        List<Object> sorted = new ArrayList<>(list);

        for (int i = 1; i < sorted.size(); i++) {
            Object key = sorted.get(i);
            int j = i - 1;

            while (j >= 0 && compareObjects(sorted.get(j), key) > 0) {
                sorted.set(j + 1, sorted.get(j));
                j = j - 1;
            }
            sorted.set(j + 1, key);
        }
        return sorted;
    }

    // helper method
    private int compareObjects(Object o1, Object o2) {
        // Use existing comparator logic
        if (containsNumbers && !containsNames) {
            NumericComparator comp = new NumericComparator();
            return comp.compare(o1, o2);
        } else if (!containsNumbers && containsNames) {
            AlphabeticComparator comp = new AlphabeticComparator();
            return comp.compare(o1, o2);
        } else {
            MixedDataComparator comp = new MixedDataComparator();
            return comp.compare(o1, o2);
        }
    }

    // new algo choice
    public String getAlgorithmName(int algorithmChoice) {
        switch(algorithmChoice) {
            case 1: return "Bubble Sort";
            case 2: return "Selection Sort";
            case 3: return "Insertion Sort";
            default: return "Default Sort";
        }
    }

    public boolean isEmpty(){
        return dataList.isEmpty();
    }

    public int getSize(){
        return dataList.size();
    }

    public void clearData(){
        dataList.clear();
        containsNumbers = false;
        containsNames = false;
    }



    private static class NumericComparator implements Comparator<Object>{
        @Override
        public int compare(Object o1, Object o2) {
            double num1 = convertToDouble(o1);
            double num2 = convertToDouble(o2);
            return Double.compare(num1,num2);
        }
        private double convertToDouble(Object obj){
            if (obj instanceof Integer){
                return (Integer) obj;
            } else if (obj instanceof Double) {
                return (Double) obj;
            } else {
                return Double.parseDouble(obj.toString());
            }
        }
    }
    private static class AlphabeticComparator implements Comparator<Object>{

        public int compare(Object o1, Object o2) {
            return o1.toString().compareToIgnoreCase(o2.toString());
        }
    }
    private static class MixedDataComparator implements Comparator<Object>{

        public int compare(Object o1, Object o2) {
            boolean isNum1 = o1 instanceof Number;
            boolean isNum2 = o2 instanceof Number;
            if (isNum1 && !isNum2) {
                return -1;
            } else if (!isNum1 && isNum2) {
                return 1;
            } else if (isNum1 && isNum2) {
                double num1 = convertToDouble(o1);
                double num2 = convertToDouble(o2);
                return Double.compare(num1,num2);
            } else {
                return o1.toString().compareToIgnoreCase(o2.toString());
            }
        }
        private double convertToDouble(Object obj){
            if (obj instanceof Integer){
                return (Integer) obj;
            }else if (obj instanceof Double) {
                return (Double) obj;
            } else  {
                return Double.parseDouble(obj.toString());
            }
        }

    }

}
